(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,50400,91478,t=>{"use strict";var e=t.i(69365),n=t.i(49604);function a(t){if(!t||""===t.trim())return 0;let e=parseFloat(t.replace(/[$,"]/g,""));return isNaN(e)?0:e}function r(t){let e=parseInt(t,10);return e>=4e3&&e<4100?"revenue":e>=5e3&&e<6e3?"cogs":e>=6e3&&e<6100?"costOfSales":e>=6100&&e<7e3?"operatingExpenses":e>=7e3&&e<8e3?"otherIncome":"operatingExpenses"}function o(t){let e=t.split(":");return e[e.length-1].trim().replace(/^\d{4}\s+/,"")}function l(t){let e=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n"),n=[],l=new Map,c=new Set,s=null,i=null;for(let t=5;t<e.length;t++){let r=e[t].trim();if(!r||",,,,,,,,,"===r||r.startsWith("Total for"))continue;let o=r.match(/^([^,]+),,,,,,,,,$/);if(o){i=function(t){let e=t.match(/^(\d{4})/);return e?e[1]:""}(s=o[1].trim());continue}if(!i||!function(t){let e=parseInt(t,10);return e>=4e3&&e<8e3}(i))continue;let l=function(t){let e=[],n="",a=!1;for(let r=0;r<t.length;r++){let o=t[r];'"'===o?a=!a:","!==o||a?n+=o:(e.push(n.trim()),n="")}return e.push(n.trim()),e}(r),c=l[1];if(!c||!/^\d{2}\/\d{2}\/\d{4}$/.test(c))continue;let u=s,d={transactionDate:c,transactionType:l[2]||"",num:l[3]||"",name:l[4]||"",classFullName:l[5]||"",memo:l[6]||"",accountFullName:u,amount:a(l[8]),balance:a(l[9])};n.push(d)}return{transactions:n.map((t,e)=>{let n,a,{code:s,parentCode:i}=function(t){if(!t)return{code:"",parentCode:null};let e=t.split(":");if(1===e.length){let e=t.match(/^(\d{4})/);return{code:e?e[1]:"",parentCode:null}}let n=e[e.length-1].trim(),a=e[0].trim(),r=n.match(/^(\d{4})/),o=a.match(/^(\d{4})/);return{code:r?r[1]:"",parentCode:o?o[1]:null}}(t.accountFullName),u=function(t){if(!t)return"";let e=t.split("/");if(3!==e.length)return"";let n=e[0].padStart(2,"0"),a=e[2];return`${a}-${n}`}(t.transactionDate);if(u&&c.add(u),s&&!l.has(s)&&l.set(s,{code:s,name:o(t.accountFullName),fullName:t.accountFullName,parentCode:i,section:r(s),children:[],depth:+!!i}),i&&s){let e=l.get(i);if(e&&!e.children.includes(s))e.children.push(s);else if(!e){let e=t.accountFullName.split(":")[0].trim();l.set(i,{code:i,name:o(e),fullName:e,parentCode:null,section:r(i),children:[s],depth:0})}}return{...t,id:(n=t.transactionDate.replace(/\//g,"-"),a=t.accountFullName.substring(0,20).replace(/[^a-zA-Z0-9]/g,""),`txn-${n}-${a}-${e}`),month:u,accountCode:s,parentAccountCode:i}}),accounts:l,months:Array.from(c).sort()}}function c(t){let e=Math.abs(t),n=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return t<0?`(${n})`:n}function s(t){let[e,n]=t.split("-");return new Date(parseInt(e),parseInt(n)-1).toLocaleDateString("en-US",{month:"short",year:"2-digit"})}t.s(["formatCurrency",()=>c,"formatMonth",()=>s,"parseCSV",()=>l],91478);let i={transactions:[],accounts:new Map,tags:{},tagConfig:{personal:["Owner's Draw","Personal Meals","Personal Travel","Personal Shopping"],nonRecurring:["One-time Setup","Settlement","Equipment Purchase","Legal Settlement"]},expandedAccounts:new Set,expandedMonths:new Set,months:[],exclusions:[],loading:!0,error:null};function u(t,e){switch(e.type){case"SET_LOADING":return{...t,loading:e.payload};case"SET_ERROR":return{...t,error:e.payload,loading:!1};case"LOAD_DATA":return{...t,transactions:e.payload.transactions,accounts:e.payload.accounts,months:e.payload.months,exclusions:e.payload.exclusions,loading:!1,error:null};case"TOGGLE_ACCOUNT":{let n=new Set(t.expandedAccounts);return n.has(e.payload)?n.delete(e.payload):n.add(e.payload),{...t,expandedAccounts:n}}case"TOGGLE_MONTH":{let n=new Set(t.expandedMonths);return n.has(e.payload)?n.delete(e.payload):n.add(e.payload),{...t,expandedMonths:n}}case"TAG_TRANSACTION":return{...t,tags:{...t.tags,[e.payload.transactionId]:e.payload.tag}};case"UNTAG_TRANSACTION":{let n={...t.tags};return delete n[e.payload],{...t,tags:n}}case"ADD_SUB_ACCOUNT":{let{category:n,name:a}=e.payload;if(t.tagConfig[n].includes(a))return t;return{...t,tagConfig:{...t.tagConfig,[n]:[...t.tagConfig[n],a]}}}case"LOAD_TAGS":return{...t,tags:e.payload.tags,tagConfig:e.payload.config};default:return t}}let d=(0,n.createContext)(null),g="pnl-tags",p="pnl-tag-config";function f({children:t}){let[a,r]=(0,n.useReducer)(u,i);return(0,n.useEffect)(()=>{!async function(){try{r({type:"SET_LOADING",payload:!0});let[t,e]=await Promise.all([fetch("/all-txn.csv"),fetch("/exclusions.csv")]);if(!t.ok)throw Error("Failed to load transaction CSV file");let n=await t.text(),{transactions:a,accounts:o,months:c}=l(n),s=[],u={};if(e.ok){let t=await e.text(),n=function(t){let e=t.trim().split("\n"),n=[];for(let t=1;t<e.length;t++){let a=e[t];if(!a.trim())continue;let r=[],o="",l=!1;for(let t=0;t<a.length;t++){let e=a[t];'"'===e?l=!l:","!==e||l?o+=e:(r.push(o.trim()),o="")}r.push(o.trim()),r.length>=8&&n.push({date:r[0],vendor:r[1],memo:r[2],account:r[3],accountCode:r[4],amount:parseFloat(r[5])||0,category:r[6],justification:r[7]})}return n}(t),r=function(t,e){let n={},a=[];for(let r of t){let t=e.find(t=>{let e=t.transactionDate,a=.01>Math.abs(t.amount-r.amount),o=e===r.date,l=t.accountCode===r.accountCode;return o&&a&&l&&!n[t.id]});t&&(n[t.id]={category:r.category.includes("Personal")||"Discretionary"===r.category?"personal":"nonRecurring",subAccount:r.category,taggedAt:Date.now()},a.push({...r,transactionId:t.id}))}return{matchedExclusions:a,tags:n}}(n,a);s=r.matchedExclusions,u=r.tags}r({type:"LOAD_DATA",payload:{transactions:a,accounts:o,months:c,exclusions:s}}),Object.keys(u).length>0&&r({type:"LOAD_TAGS",payload:{tags:u,config:i.tagConfig}})}catch(t){r({type:"SET_ERROR",payload:t instanceof Error?t.message:"Unknown error"})}}()},[]),(0,n.useEffect)(()=>{try{let t=localStorage.getItem(g),e=localStorage.getItem(p);(t||e)&&r({type:"LOAD_TAGS",payload:{tags:t?JSON.parse(t):{},config:e?JSON.parse(e):i.tagConfig}})}catch(t){console.error("Failed to load tags from localStorage:",t)}},[]),(0,n.useEffect)(()=>{if(!a.loading)try{localStorage.setItem(g,JSON.stringify(a.tags)),localStorage.setItem(p,JSON.stringify(a.tagConfig))}catch(t){console.error("Failed to save tags to localStorage:",t)}},[a.tags,a.tagConfig,a.loading]),(0,e.jsx)(d.Provider,{value:{state:a,dispatch:r},children:t})}function m(){let t=(0,n.useContext)(d);if(!t)throw Error("usePL must be used within a PLProvider");return t}t.s(["PLProvider",()=>f,"usePL",()=>m],50400)}]);