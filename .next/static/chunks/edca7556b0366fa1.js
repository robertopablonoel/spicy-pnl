(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25735,e=>{"use strict";var t=e.i(69365),s=e.i(50400),r=e.i(49604);function l(e,t,s,r,a=!1){let n=s.get(e);if(!n)return[];let o=t.filter(t=>{let l=t.accountCode===e||t.parentAccountCode===e&&!s.has(t.accountCode),n=void 0!==r[t.id];return l&&(a||!n)});for(let e of n.children)o=o.concat(l(e,t,s,r,a));return o}function a(e,t,s,r,a){let n=l(e,t,s,a),o={};r.forEach(e=>{o[e]=0});let c=0;for(let e of n)e.month&&void 0!==o[e.month]&&(o[e.month]+=e.amount,c+=e.amount);return{monthlyAmounts:o,ytdTotal:c,transactionCount:n.length}}function n(e,t,s,r,l){return t.filter(t=>{if(l[t.id]||t.month!==r)return!1;let a=s.get(t.accountCode);if(!a)return!1;if(a.section===e)return!0;if(t.parentAccountCode){let r=s.get(t.parentAccountCode);if(r?.section===e)return!0}return!1}).reduce((e,t)=>e+t.amount,0)}var o=e.i(91478);function c(){let{state:e}=(0,s.usePL)(),l=(0,r.useMemo)(()=>{var t,s,r;let l,a,n,o,c,i,d,x,m,u,h,p,f;return 0===e.transactions.length?null:(t=e.transactions,s=e.accounts,r=e.tags,l=t.filter(e=>!r[e.id]),a=t.filter(e=>r[e.id]),n=e=>l.filter(t=>{let r=s.get(t.accountCode);if(!r)return!1;if(r.section===e)return!0;if(t.parentAccountCode){let r=s.get(t.parentAccountCode);if(r?.section===e)return!0}return!1}).reduce((e,t)=>e+t.amount,0),i=(c=(o=l.filter(e=>{let t=parseInt(e.accountCode,10);return t>=4e3&&t<4100})).filter(e=>"4000"===e.accountCode||"4030"===e.accountCode).reduce((e,t)=>e+t.amount,0))+o.filter(e=>"4010"===e.accountCode||"4020"===e.accountCode||"4040"===e.accountCode).reduce((e,t)=>e+t.amount,0),d=n("cogs"),x=n("costOfSales"),m=n("operatingExpenses"),u=n("otherIncome"),p=(h=i-d-x)-m+u,f=a.reduce((e,t)=>e+t.amount,0),{grossRevenue:c,netRevenue:i,totalCOGS:d,totalCostOfSales:x,grossProfit:h,grossMargin:0!==i?h/i*100:0,totalOpEx:m,otherIncome:u,netIncome:p,netMargin:0!==i?p/i*100:0,taggedItemsCount:a.length,taggedAmount:f})},[e.transactions,e.accounts,e.tags]);if(!l)return null;let a=[{label:"Net Revenue",value:l.netRevenue,color:"bg-emerald-50 border-emerald-200",textColor:"text-emerald-700",valueColor:"text-emerald-900"},{label:"Gross Profit",value:l.grossProfit,subLabel:`${l.grossMargin.toFixed(1)}% margin`,color:"bg-blue-50 border-blue-200",textColor:"text-blue-700",valueColor:"text-blue-900"},{label:"Net Income",value:l.netIncome,subLabel:`${l.netMargin.toFixed(1)}% margin`,color:l.netIncome>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200",textColor:l.netIncome>=0?"text-green-700":"text-red-700",valueColor:l.netIncome>=0?"text-green-900":"text-red-900"},{label:"Tagged Items",value:l.taggedAmount,subLabel:`${l.taggedItemsCount} transactions`,color:"bg-amber-50 border-amber-200",textColor:"text-amber-700",valueColor:"text-amber-900"}];return(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:a.map(e=>(0,t.jsxs)("div",{className:`${e.color} border rounded-lg p-4 shadow-sm`,children:[(0,t.jsx)("div",{className:`text-sm font-medium ${e.textColor}`,children:e.label}),(0,t.jsx)("div",{className:`text-2xl font-bold ${e.valueColor} mt-1`,children:(0,o.formatCurrency)(e.value)}),e.subLabel&&(0,t.jsx)("div",{className:`text-xs ${e.textColor} mt-1 opacity-75`,children:e.subLabel})]},e.label))})}function i({expanded:e,className:s=""}){return(0,t.jsx)("svg",{className:`w-4 h-4 transition-transform duration-200 ${e?"rotate-90":""} ${s}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}function d({transaction:e,onClose:l}){let{state:a,dispatch:n}=(0,s.usePL)(),[c,i]=(0,r.useState)("personal"),[d,x]=(0,r.useState)(""),[m,u]=(0,r.useState)(!1),h=t=>{n({type:"TAG_TRANSACTION",payload:{transactionId:e.id,tag:{category:c,subAccount:t,taggedAt:Date.now()}}}),l()},p=()=>{d.trim()&&(n({type:"ADD_SUB_ACCOUNT",payload:{category:c,name:d.trim()}}),h(d.trim()))},f=a.tagConfig[c];return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:l,children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"px-4 py-3 border-b border-slate-200",children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-900",children:"Tag Transaction"}),(0,t.jsxs)("p",{className:"text-sm text-slate-500 mt-1 truncate",children:[e.name||e.memo," - ",(0,o.formatCurrency)(e.amount)]})]}),(0,t.jsxs)("div",{className:"flex border-b border-slate-200",children:[(0,t.jsx)("button",{className:`flex-1 px-4 py-2 text-sm font-medium border-b-2 transition-colors
              ${"personal"===c?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700"}
            `,onClick:()=>i("personal"),children:"Personal"}),(0,t.jsx)("button",{className:`flex-1 px-4 py-2 text-sm font-medium border-b-2 transition-colors
              ${"nonRecurring"===c?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700"}
            `,onClick:()=>i("nonRecurring"),children:"Non-Recurring"})]}),(0,t.jsx)("div",{className:"p-4 max-h-64 overflow-y-auto",children:(0,t.jsxs)("div",{className:"space-y-2",children:[f.map(e=>(0,t.jsx)("button",{onClick:()=>h(e),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100 text-slate-700 transition-colors",children:e},e)),m?(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:d,onChange:e=>x(e.target.value),placeholder:"Enter name...",className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&p(),"Escape"===e.key&&u(!1)}}),(0,t.jsx)("button",{onClick:p,disabled:!d.trim(),className:"px-3 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add"})]}):(0,t.jsxs)("button",{onClick:()=>u(!0),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-blue-50 text-blue-600 transition-colors flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add new sub-account"]})]})}),(0,t.jsx)("div",{className:"px-4 py-3 border-t border-slate-200 flex justify-end",children:(0,t.jsx)("button",{onClick:l,className:"px-4 py-2 text-sm text-slate-600 hover:text-slate-800",children:"Cancel"})})]})})}function x({transaction:e}){let{state:l,dispatch:a}=(0,s.usePL)(),[n,c]=(0,r.useState)(!1),i=l.tags[e.id],x=!!i;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:`
          flex items-center gap-3 py-1.5 px-2 rounded text-sm
          ${x?"bg-amber-50 opacity-60":"bg-white hover:bg-slate-50"}
        `,children:[(0,t.jsx)("span",{className:"text-slate-400 font-mono text-xs w-12 flex-shrink-0",children:(e=>{let[t,s]=e.split("/");return`${t}/${s}`})(e.transactionDate)}),(0,t.jsx)("span",{className:`font-medium w-32 flex-shrink-0 truncate ${x?"line-through text-slate-400":"text-slate-700"}`,children:e.name||"-"}),(0,t.jsx)("span",{className:`flex-1 truncate ${x?"line-through text-slate-400":"text-slate-500"}`,children:e.memo||e.transactionType}),x&&(0,t.jsx)("span",{className:"bg-amber-200 text-amber-800 text-xs px-2 py-0.5 rounded-full flex-shrink-0",children:i.subAccount}),(0,t.jsx)("span",{className:`font-mono text-right w-24 flex-shrink-0
          ${x?"line-through text-slate-400":e.amount<0?"text-red-600":"text-slate-700"}
        `,children:(0,o.formatCurrency)(e.amount)}),x?(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),a({type:"UNTAG_TRANSACTION",payload:e.id})},className:"text-xs text-red-600 hover:text-red-800 px-2 py-1 rounded hover:bg-red-50 flex-shrink-0",children:"Untag"}):(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),c(!0)},className:"text-xs text-blue-600 hover:text-blue-800 px-2 py-1 rounded hover:bg-blue-50 flex-shrink-0",children:"Tag"})]}),n&&(0,t.jsx)(d,{transaction:e,onClose:()=>c(!1)})]})}function m({row:e,months:n,depth:c=0,isChild:d=!1}){let{state:u,dispatch:h}=(0,s.usePL)(),{expandedAccounts:p,expandedMonths:f,transactions:g,accounts:b,tags:j}=u,y=p.has(e.accountCode),N=e.account.children.length>0,w=e.transactionCount>0,C=N||w,v=(0,r.useMemo)(()=>y&&N?e.account.children.map(e=>{let t=b.get(e);if(!t)return null;let{monthlyAmounts:s,ytdTotal:r,transactionCount:l}=a(e,g,b,n,j);return 0===r&&0===l?null:{accountCode:e,account:t,monthlyAmounts:s,ytdTotal:r,transactionCount:l}}).filter(e=>null!==e):[],[y,N,e.account.children,b,g,n,j]),k=(0,r.useMemo)(()=>{if(!y||N)return{};var t=l(e.accountCode,g,b,j);let s={};for(let e of t)s[e.month]||(s[e.month]=[]),s[e.month].push(e);for(let e of Object.keys(s))s[e].sort((e,t)=>{let s=new Date(e.transactionDate),r=new Date(t.transactionDate);return s.getTime()-r.getTime()});return s},[y,N,e.accountCode,g,b,j]),$=20*c;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{className:`
          ${d?"bg-slate-50/50":"bg-white"}
          ${C?"cursor-pointer hover:bg-slate-100":""}
          border-b border-slate-100
        `,onClick:()=>{C&&h({type:"TOGGLE_ACCOUNT",payload:e.accountCode})},children:[(0,t.jsx)("td",{className:"sticky left-0 bg-inherit px-3 py-2 font-medium text-slate-900 whitespace-nowrap z-10",style:{paddingLeft:`${12+$}px`},children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[C?(0,t.jsx)(i,{expanded:y,className:"text-slate-400 flex-shrink-0"}):(0,t.jsx)("span",{className:"w-4"}),(0,t.jsx)("span",{className:c>0?"text-sm":"",children:e.account.name})]})}),n.map(s=>(0,t.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm whitespace-nowrap
              ${e.monthlyAmounts[s]<0?"text-red-600":"text-slate-700"}
            `,children:0!==e.monthlyAmounts[s]?(0,o.formatCurrency)(e.monthlyAmounts[s]):"-"},s)),(0,t.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm font-semibold whitespace-nowrap
            ${e.ytdTotal<0?"text-red-600":"text-slate-900"}
          `,children:(0,o.formatCurrency)(e.ytdTotal)})]}),y&&v.map(e=>(0,t.jsx)(m,{row:e,months:n,depth:c+1,isChild:!0},e.accountCode)),y&&!N&&Object.keys(k).length>0&&(0,t.jsx)(t.Fragment,{children:n.filter(e=>k[e]?.length>0).map(s=>{let r=k[s]||[],l=f.has(`${e.accountCode}-${s}`);return(0,t.jsx)("tr",{className:"bg-slate-50",children:(0,t.jsxs)("td",{colSpan:n.length+2,className:"px-3 py-1",style:{paddingLeft:`${32+$}px`},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600 cursor-pointer hover:text-slate-900",onClick:t=>{t.stopPropagation(),h({type:"TOGGLE_MONTH",payload:`${e.accountCode}-${s}`})},children:[(0,t.jsx)(i,{expanded:l,className:"text-slate-400"}),(0,t.jsx)("span",{className:"font-medium",children:(0,o.formatMonth)(s)}),(0,t.jsxs)("span",{className:"text-slate-400",children:["(",r.length," transactions)"]}),(0,t.jsx)("span",{className:"ml-auto font-mono",children:(0,o.formatCurrency)(r.reduce((e,t)=>e+t.amount,0))})]}),l&&(0,t.jsx)("div",{className:"mt-2 space-y-1 pb-2",children:r.map(e=>(0,t.jsx)(x,{transaction:e},e.id))})]})},`${e.accountCode}-${s}-group`)})})]})}function u({section:e,title:l,colorClass:c}){let{state:i}=(0,s.usePL)(),{transactions:d,accounts:x,months:u,tags:h}=i,p=(0,r.useMemo)(()=>{if(0===d.length)return[];let t=[];for(let s of Array.from(x.values()).filter(t=>t.section===e&&null===t.parentCode).sort((e,t)=>e.code.localeCompare(t.code))){let{monthlyAmounts:e,ytdTotal:r,transactionCount:l}=a(s.code,d,x,u,h);(0!==r||l>0)&&t.push({accountCode:s.code,account:s,monthlyAmounts:e,ytdTotal:r,transactionCount:l})}return t},[e,d,x,u,h]),f=(0,r.useMemo)(()=>{let t={},s=0;return u.forEach(r=>{let l=n(e,d,x,r,h);t[r]=l,s+=l}),{monthly:t,ytd:s}},[e,d,x,u,h]);return 0===p.length?null:(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("div",{className:`w-1 h-6 rounded ${c}`}),(0,t.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:l})]}),(0,t.jsx)("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:(0,t.jsxs)("table",{className:"w-full min-w-max",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-slate-50 border-b border-slate-200",children:[(0,t.jsx)("th",{className:"sticky left-0 bg-slate-50 px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:"Account"}),u.map(e=>(0,t.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,o.formatMonth)(e)},e)),(0,t.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-28 bg-slate-100",children:"YTD Total"})]})}),(0,t.jsxs)("tbody",{children:[p.map(e=>(0,t.jsx)(m,{row:e,months:u},e.accountCode)),(0,t.jsxs)("tr",{className:`${c.replace("bg-","bg-opacity-10 bg-")} border-t-2 border-slate-300`,children:[(0,t.jsxs)("td",{className:"sticky left-0 bg-inherit px-3 py-2 font-bold text-slate-900",children:["Total ",l]}),u.map(e=>(0,t.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm font-bold
                    ${f.monthly[e]<0?"text-red-600":"text-slate-900"}
                  `,children:(0,o.formatCurrency)(f.monthly[e])},e)),(0,t.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm font-bold bg-slate-100
                  ${f.ytd<0?"text-red-600":"text-slate-900"}
                `,children:(0,o.formatCurrency)(f.ytd)})]})]})]})})]})}function h({type:e}){let{state:l}=(0,s.usePL)(),{transactions:a,accounts:c,months:i,tags:d}=l,x=(0,r.useMemo)(()=>{let e={},t={},s={},r={},l={},o=0,x=0,m=0,u=0,h=0;i.forEach(i=>{e[i]=n("revenue",a,c,i,d),t[i]=n("cogs",a,c,i,d),s[i]=n("costOfSales",a,c,i,d),r[i]=n("operatingExpenses",a,c,i,d),l[i]=n("otherIncome",a,c,i,d),o+=e[i],x+=t[i],m+=s[i],u+=r[i],h+=l[i]});let p={},f={},g=0,b=0;return i.forEach(a=>{p[a]=e[a]-t[a]-s[a],f[a]=p[a]-r[a]+l[a],g+=p[a],b+=f[a]}),{grossProfit:{monthly:p,ytd:g},netIncome:{monthly:f,ytd:b},revenue:{monthly:e,ytd:o}}},[a,c,i,d]);if(0===a.length)return null;let m="grossProfit"===e?x.grossProfit:x.netIncome,u="grossProfit"===e?"bg-blue-50":"bg-green-50",h="grossProfit"===e?"border-blue-200":"border-green-200",p=0!==x.revenue.ytd?m.ytd/x.revenue.ytd*100:0;return(0,t.jsx)("div",{className:`mb-6 overflow-x-auto border ${h} rounded-lg`,children:(0,t.jsxs)("table",{className:"w-full min-w-max",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:`${u} border-b ${h}`,children:[(0,t.jsx)("th",{className:"sticky left-0 bg-inherit px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:" "}),i.map(e=>(0,t.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,o.formatMonth)(e)},e)),(0,t.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-28",children:"YTD Total"})]})}),(0,t.jsx)("tbody",{children:(0,t.jsxs)("tr",{className:u,children:[(0,t.jsxs)("td",{className:"sticky left-0 bg-inherit px-3 py-3 font-bold text-lg text-slate-900",children:["grossProfit"===e?"Gross Profit":"Net Income",(0,t.jsxs)("span",{className:"ml-2 text-sm font-normal text-slate-500",children:["(",p.toFixed(1),"% margin)"]})]}),i.map(e=>(0,t.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg
                  ${m.monthly[e]<0?"text-red-600":"text-slate-900"}
                `,children:(0,o.formatCurrency)(m.monthly[e])},e)),(0,t.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg
                ${m.ytd<0?"text-red-600":"text-slate-900"}
              `,children:(0,o.formatCurrency)(m.ytd)})]})})]})})}let p={Sales:["4000","4030"],Discounts:["4010"],Refunds:["4020"],Chargebacks:["4040"]},f={"Product Costs + Shipping":["5000","5010","5030","5040","5050"]},g={"Google Ads":{accounts:["6110"],filter:e=>e.name.toLowerCase().includes("google")},"Facebook Ads":{accounts:["6110"],filter:e=>e.name.toLowerCase().includes("facebook")||e.name.toLowerCase().includes("facebk")},"Other Paid Ads":{accounts:["6110"],filter:e=>!e.name.toLowerCase().includes("google")&&!e.name.toLowerCase().includes("facebook")&&!e.name.toLowerCase().includes("facebk")},"Processing Fees":{accounts:["6055","6065","6075"]},"Affiliate / Creator Payouts":{accounts:["6120","6125"]},"Marketing Agencies":{accounts:["6130"]},"Shopify Apps":{accounts:["6070"]},"Marketing Software":{accounts:["6140"]},"Fulfillment (3PL + Shipping)":{accounts:["6010","6020","6035"]},"Virtual Assistants / Contractors":{accounts:["6240"]},"Other Software":{accounts:["6375"]},Accounting:{accounts:["6330"]},"Other Expenses":{accounts:["6100","6150","6210","6250","6260","6290","6300","6320","6390","6410","6450","6470","6495"]}};function b(){let{state:e}=(0,s.usePL)(),{transactions:l,months:a,tags:n}=e,{income:c,cogs:i,expenses:d}=(0,r.useMemo)(()=>0===l.length?{income:[],cogs:[],expenses:[]}:function(e,t,s){let r=e.filter(e=>!t[e.id]),l=(e,t)=>{let l={};s.forEach(e=>{l[e]=0});let a=0;for(let s of r)e.includes(s.accountCode)&&(!t||t(s))&&void 0!==l[s.month]&&(l[s.month]+=s.amount,a+=s.amount);return{monthly:l,ytd:a}},a=[],n={},o=0;for(let[e,t]of(s.forEach(e=>{n[e]=0}),Object.entries(p))){let{monthly:r,ytd:c}=l(t);a.push({label:e,monthlyAmounts:r,ytd:c}),s.forEach(e=>{n[e]+=r[e]}),o+=c}a.push({label:"Total Income",monthlyAmounts:n,ytd:o,isTotal:!0,isBold:!0});let c=[],i={},d=0;for(let[e,t]of(s.forEach(e=>{i[e]=0}),Object.entries(f))){let{monthly:r,ytd:a}=l(t);c.push({label:e,monthlyAmounts:r,ytd:a}),s.forEach(e=>{i[e]+=r[e]}),d+=a}let x={};s.forEach(e=>{x[e]=n[e]-i[e]});let m=o-d;c.push({label:"Gross Profit",monthlyAmounts:x,ytd:m,isTotal:!0,isBold:!0});let u=[],h={},b=0;for(let[e,t]of(s.forEach(e=>{h[e]=0}),Object.entries(g))){let{monthly:r,ytd:a}=l("accounts"in t?t.accounts:t,"filter"in t?t.filter:void 0);0!==a&&(u.push({label:e,monthlyAmounts:r,ytd:a,indent:1}),s.forEach(e=>{h[e]+=r[e]}),b+=a)}u.push({label:"Total Expenses",monthlyAmounts:h,ytd:b,isTotal:!0,isBold:!0});let j={};s.forEach(e=>{j[e]=x[e]-h[e]});let y=m-b;return u.push({label:"Net Profit",monthlyAmounts:j,ytd:y,isTotal:!0,isBold:!0}),{income:a,cogs:c,expenses:u}}(l,n,a),[l,n,a]);if(0===l.length)return null;let x=(e,s,r,l)=>(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("div",{className:`w-1 h-6 rounded ${r}`}),(0,t.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:e})]}),(0,t.jsx)("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:(0,t.jsxs)("table",{className:"w-full min-w-max",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-slate-50 border-b border-slate-200",children:[(0,t.jsx)("th",{className:"sticky left-0 bg-slate-50 px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:"Account"}),a.map(e=>(0,t.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,o.formatMonth)(e)},e)),(0,t.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-28 bg-slate-100",children:"YTD Total"})]})}),(0,t.jsx)("tbody",{children:s.map((e,s)=>(0,t.jsxs)("tr",{className:`
                  ${e.isTotal?`${l} border-t-2 border-slate-300`:"border-b border-slate-100 hover:bg-slate-50"}
                `,children:[(0,t.jsx)("td",{className:`sticky left-0 bg-inherit px-3 py-2 text-slate-900 ${e.isBold?"font-bold":""} ${e.indent?"pl-6":""}`,children:e.label}),a.map(s=>(0,t.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm
                      ${e.isBold?"font-bold":""}
                      ${e.monthlyAmounts[s]<0?"text-red-600":"text-slate-900"}
                    `,children:(0,o.formatCurrency)(e.monthlyAmounts[s])},s)),(0,t.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm bg-slate-100
                    ${e.isBold?"font-bold":""}
                    ${e.ytd<0?"text-red-600":"text-slate-900"}
                  `,children:(0,o.formatCurrency)(e.ytd)})]},s))})]})})]}),m=i.find(e=>"Gross Profit"===e.label),u=d.find(e=>"Net Profit"===e.label),h=i.filter(e=>"Gross Profit"!==e.label),b=d.filter(e=>"Net Profit"!==e.label),j=(e,s,r,l)=>{if(!e)return null;let n=c[c.length-1]?.ytd!==0?e.ytd/c[c.length-1].ytd*100:0;return(0,t.jsx)("div",{className:`mb-6 overflow-x-auto border ${l} rounded-lg`,children:(0,t.jsxs)("table",{className:"w-full min-w-max",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:`${r} border-b ${l}`,children:[(0,t.jsx)("th",{className:"sticky left-0 bg-inherit px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:" "}),a.map(e=>(0,t.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,o.formatMonth)(e)},e)),(0,t.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-28",children:"YTD Total"})]})}),(0,t.jsx)("tbody",{children:(0,t.jsxs)("tr",{className:r,children:[(0,t.jsxs)("td",{className:"sticky left-0 bg-inherit px-3 py-3 font-bold text-lg text-slate-900",children:[s,(0,t.jsxs)("span",{className:"ml-2 text-sm font-normal text-slate-500",children:["(",n.toFixed(1),"% margin)"]})]}),a.map(s=>(0,t.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg
                    ${e.monthlyAmounts[s]<0?"text-red-600":"text-slate-900"}
                  `,children:(0,o.formatCurrency)(e.monthlyAmounts[s])},s)),(0,t.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg
                  ${e.ytd<0?"text-red-600":"text-slate-900"}
                `,children:(0,o.formatCurrency)(e.ytd)})]})})]})})};return(0,t.jsxs)("div",{children:[x("Income",c,"bg-emerald-500","bg-emerald-50"),x("Cost of Goods",h,"bg-orange-500","bg-orange-50"),j(m,"Gross Profit","bg-blue-50","border-blue-200"),x("Expenses",b,"bg-red-500","bg-red-50"),j(u,"Net Profit","bg-green-50","border-green-200")]})}function j(){let{state:e}=(0,s.usePL)(),[l,a]=(0,r.useState)(!1),[n,c]=(0,r.useState)(new Set),d=(0,r.useMemo)(()=>{let t={};for(let s of e.exclusions)t[s.category]||(t[s.category]={exclusions:[],total:0,justification:s.justification}),t[s.category].exclusions.push(s),t[s.category].total+=s.amount;return t},[e.exclusions]),x=(0,r.useMemo)(()=>e.exclusions.reduce((e,t)=>e+t.amount,0),[e.exclusions]),m=Object.keys(d).sort();return 0===e.exclusions.length?null:(0,t.jsxs)("div",{className:"mt-8 pt-6 border-t-2 border-slate-300",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4 cursor-pointer hover:opacity-80",onClick:()=>a(!l),children:[(0,t.jsx)(i,{expanded:l,className:"text-slate-400"}),(0,t.jsx)("div",{className:"w-1 h-6 rounded bg-amber-500"}),(0,t.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Exclusions"}),(0,t.jsxs)("span",{className:"text-sm text-slate-500",children:["(",e.exclusions.length," items excluded from P&L)"]}),(0,t.jsx)("span",{className:"ml-auto font-mono font-semibold text-slate-700",children:(0,o.formatCurrency)(x)})]}),l&&(0,t.jsxs)("div",{className:"space-y-3 pl-6",children:[(0,t.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"The following expenses have been excluded as non-recurring or owner-related items that would not transfer to a buyer."}),m.map(e=>{let s=d[e],r=n.has(e);return(0,t.jsxs)("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 bg-slate-50 cursor-pointer hover:bg-slate-100",onClick:()=>{let t;(t=new Set(n)).has(e)?t.delete(e):t.add(e),c(t)},children:[(0,t.jsx)(i,{expanded:r,className:"text-slate-400"}),(0,t.jsx)("div",{className:`w-2 h-2 rounded-full ${{Personal:"bg-purple-500",Discretionary:"bg-purple-400","Owner Travel":"bg-blue-500","Owner Education":"bg-blue-400","Owner Tools":"bg-blue-300","Owner Expense":"bg-blue-600",Legal:"bg-red-500","Legal/Tax":"bg-red-400","One-Time Project":"bg-amber-500","One-Time COGS":"bg-amber-400","Terminated Agency":"bg-orange-500","Terminated Contractor":"bg-orange-400","Terminated Service":"bg-orange-300","M&A Process":"bg-slate-500"}[e]||"bg-slate-400"}`}),(0,t.jsx)("span",{className:"font-semibold text-slate-900",children:e}),(0,t.jsxs)("span",{className:"text-sm text-slate-500",children:["(",s.exclusions.length," items)"]}),(0,t.jsx)("span",{className:"ml-auto text-xs text-slate-500 max-w-md truncate",children:s.justification}),(0,t.jsx)("span",{className:"font-mono font-semibold text-slate-700 ml-4",children:(0,o.formatCurrency)(s.total)})]}),r&&(0,t.jsx)("div",{className:"divide-y divide-slate-100",children:s.exclusions.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-4 px-6 py-2 bg-white text-sm hover:bg-slate-50",children:[(0,t.jsx)("span",{className:"text-slate-400 w-24",children:e.date}),(0,t.jsx)("span",{className:"text-slate-700 flex-1 truncate",children:e.vendor||e.memo?.substring(0,40)||"Unknown"}),(0,t.jsx)("span",{className:"text-slate-500 text-xs w-32 truncate",children:e.account.replace(/^\d{4}\s+/,"")}),(0,t.jsx)("span",{className:"font-mono text-slate-600 w-24 text-right",children:(0,o.formatCurrency)(e.amount)})]},`${e.date}-${e.amount}-${s}`))})]},e)})]})]})}function y(){let{state:e,dispatch:r}=(0,s.usePL)();return e.loading?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 text-slate-500",children:[(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("span",{children:"Loading financial data..."})]})}):e.error?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"text-red-600 bg-red-50 px-6 py-4 rounded-lg border border-red-200",children:[(0,t.jsx)("strong",{children:"Error:"})," ",e.error]})}):(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-center justify-end mb-4",children:(0,t.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,t.jsx)("span",{className:`text-sm font-medium ${e.khBrokersView?"text-slate-400":"text-slate-900"}`,children:"Detailed View"}),(0,t.jsx)("button",{onClick:()=>{r({type:"TOGGLE_KH_BROKERS_VIEW"})},className:`relative w-14 h-7 rounded-full transition-colors duration-200 ${e.khBrokersView?"bg-emerald-500":"bg-slate-300"}`,children:(0,t.jsx)("span",{className:`absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform duration-200 ${e.khBrokersView?"translate-x-8":"translate-x-1"}`})}),(0,t.jsx)("span",{className:`text-sm font-medium ${e.khBrokersView?"text-slate-900":"text-slate-400"}`,children:"KH Brokers View"})]})}),(0,t.jsx)(c,{}),e.khBrokersView?(0,t.jsx)(b,{}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u,{section:"revenue",title:"Revenue",colorClass:"bg-emerald-500"}),(0,t.jsx)(u,{section:"cogs",title:"Cost of Goods Sold",colorClass:"bg-orange-500"}),(0,t.jsx)(u,{section:"costOfSales",title:"Cost of Sales",colorClass:"bg-amber-500"}),(0,t.jsx)(h,{type:"grossProfit"}),(0,t.jsx)(u,{section:"operatingExpenses",title:"Operating Expenses",colorClass:"bg-red-500"}),(0,t.jsx)(h,{type:"netIncome"})]}),(0,t.jsx)(j,{})]})}e.s(["PLViewer",()=>y],25735)}]);