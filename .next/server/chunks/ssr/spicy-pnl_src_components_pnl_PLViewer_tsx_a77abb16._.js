module.exports=[7839,a=>{"use strict";var b=a.i(82332),c=a.i(1163),d=a.i(55005);function e(a,b,c,d,f=!1){let g=c.get(a);if(!g)return[];let h=b.filter(b=>{let e=b.accountCode===a||b.parentAccountCode===a&&!c.has(b.accountCode),g=void 0!==d[b.id];return e&&(f||!g)});for(let a of g.children)h=h.concat(e(a,b,c,d,f));return h}function f(a,b,c,d,f){let g=e(a,b,c,f),h={};d.forEach(a=>{h[a]=0});let i=0;for(let a of g)a.month&&void 0!==h[a.month]&&(h[a.month]+=a.amount,i+=a.amount);return{monthlyAmounts:h,ytdTotal:i,transactionCount:g.length}}function g(a,b,c,d,e){return b.filter(b=>{if(e[b.id]||b.month!==d)return!1;let f=c.get(b.accountCode);if(!f)return!1;if(f.section===a)return!0;if(b.parentAccountCode){let d=c.get(b.parentAccountCode);if(d?.section===a)return!0}return!1}).reduce((a,b)=>a+b.amount,0)}var h=a.i(46726);function i(){let{state:a}=(0,c.usePL)(),e=(0,d.useMemo)(()=>{var b,c,d;let e,f,g,h,i,j,k,l,m,n,o,p,q;return 0===a.transactions.length?null:(b=a.transactions,c=a.accounts,d=a.tags,e=b.filter(a=>!d[a.id]),f=b.filter(a=>d[a.id]),g=a=>e.filter(b=>{let d=c.get(b.accountCode);if(!d)return!1;if(d.section===a)return!0;if(b.parentAccountCode){let d=c.get(b.parentAccountCode);if(d?.section===a)return!0}return!1}).reduce((a,b)=>a+b.amount,0),j=(i=(h=e.filter(a=>{let b=parseInt(a.accountCode,10);return b>=4e3&&b<4100})).filter(a=>"4000"===a.accountCode||"4030"===a.accountCode).reduce((a,b)=>a+b.amount,0))+h.filter(a=>"4010"===a.accountCode||"4020"===a.accountCode||"4040"===a.accountCode).reduce((a,b)=>a+b.amount,0),k=g("cogs"),l=g("costOfSales"),m=g("operatingExpenses"),n=g("otherIncome"),p=(o=j-k-l)-m+n,q=f.reduce((a,b)=>a+b.amount,0),{grossRevenue:i,netRevenue:j,totalCOGS:k,totalCostOfSales:l,grossProfit:o,grossMargin:0!==j?o/j*100:0,totalOpEx:m,otherIncome:n,netIncome:p,netMargin:0!==j?p/j*100:0,taggedItemsCount:f.length,taggedAmount:q})},[a.transactions,a.accounts,a.tags]);if(!e)return null;let f=[{label:"Net Revenue",value:e.netRevenue,color:"bg-emerald-50 border-emerald-200",textColor:"text-emerald-700",valueColor:"text-emerald-900"},{label:"Gross Profit",value:e.grossProfit,subLabel:`${e.grossMargin.toFixed(1)}% margin`,color:"bg-blue-50 border-blue-200",textColor:"text-blue-700",valueColor:"text-blue-900"},{label:"Net Income",value:e.netIncome,subLabel:`${e.netMargin.toFixed(1)}% margin`,color:e.netIncome>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200",textColor:e.netIncome>=0?"text-green-700":"text-red-700",valueColor:e.netIncome>=0?"text-green-900":"text-red-900"},{label:"Tagged Items",value:e.taggedAmount,subLabel:`${e.taggedItemsCount} transactions`,color:"bg-amber-50 border-amber-200",textColor:"text-amber-700",valueColor:"text-amber-900"}];return(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:f.map(a=>(0,b.jsxs)("div",{className:`${a.color} border rounded-lg p-4 shadow-sm`,children:[(0,b.jsx)("div",{className:`text-sm font-medium ${a.textColor}`,children:a.label}),(0,b.jsx)("div",{className:`text-2xl font-bold ${a.valueColor} mt-1`,children:(0,h.formatCurrency)(a.value)}),a.subLabel&&(0,b.jsx)("div",{className:`text-xs ${a.textColor} mt-1 opacity-75`,children:a.subLabel})]},a.label))})}function j({expanded:a,className:c=""}){return(0,b.jsx)("svg",{className:`w-4 h-4 transition-transform duration-200 ${a?"rotate-90":""} ${c}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}function k({transaction:a,onClose:e}){let{state:f,dispatch:g}=(0,c.usePL)(),[i,j]=(0,d.useState)("personal"),[k,l]=(0,d.useState)(""),[m,n]=(0,d.useState)(!1),o=b=>{g({type:"TAG_TRANSACTION",payload:{transactionId:a.id,tag:{category:i,subAccount:b,taggedAt:Date.now()}}}),e()},p=()=>{k.trim()&&(g({type:"ADD_SUB_ACCOUNT",payload:{category:i,name:k.trim()}}),o(k.trim()))},q=f.tagConfig[i];return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:e,children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"px-4 py-3 border-b border-slate-200",children:[(0,b.jsx)("h3",{className:"font-semibold text-slate-900",children:"Tag Transaction"}),(0,b.jsxs)("p",{className:"text-sm text-slate-500 mt-1 truncate",children:[a.name||a.memo," - ",(0,h.formatCurrency)(a.amount)]})]}),(0,b.jsxs)("div",{className:"flex border-b border-slate-200",children:[(0,b.jsx)("button",{className:`flex-1 px-4 py-2 text-sm font-medium border-b-2 transition-colors
              ${"personal"===i?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700"}
            `,onClick:()=>j("personal"),children:"Personal"}),(0,b.jsx)("button",{className:`flex-1 px-4 py-2 text-sm font-medium border-b-2 transition-colors
              ${"nonRecurring"===i?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700"}
            `,onClick:()=>j("nonRecurring"),children:"Non-Recurring"})]}),(0,b.jsx)("div",{className:"p-4 max-h-64 overflow-y-auto",children:(0,b.jsxs)("div",{className:"space-y-2",children:[q.map(a=>(0,b.jsx)("button",{onClick:()=>o(a),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100 text-slate-700 transition-colors",children:a},a)),m?(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"text",value:k,onChange:a=>l(a.target.value),placeholder:"Enter name...",className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0,onKeyDown:a=>{"Enter"===a.key&&p(),"Escape"===a.key&&n(!1)}}),(0,b.jsx)("button",{onClick:p,disabled:!k.trim(),className:"px-3 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add"})]}):(0,b.jsxs)("button",{onClick:()=>n(!0),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-blue-50 text-blue-600 transition-colors flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add new sub-account"]})]})}),(0,b.jsx)("div",{className:"px-4 py-3 border-t border-slate-200 flex justify-end",children:(0,b.jsx)("button",{onClick:e,className:"px-4 py-2 text-sm text-slate-600 hover:text-slate-800",children:"Cancel"})})]})})}function l({transaction:a}){let{state:e,dispatch:f}=(0,c.usePL)(),[g,i]=(0,d.useState)(!1),j=e.tags[a.id],l=!!j;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:`
          flex items-center gap-3 py-1.5 px-2 rounded text-sm
          ${l?"bg-amber-50 opacity-60":"bg-white hover:bg-slate-50"}
        `,children:[(0,b.jsx)("span",{className:"text-slate-400 font-mono text-xs w-12 flex-shrink-0",children:(a=>{let[b,c]=a.split("/");return`${b}/${c}`})(a.transactionDate)}),(0,b.jsx)("span",{className:`font-medium w-32 flex-shrink-0 truncate ${l?"line-through text-slate-400":"text-slate-700"}`,children:a.name||"-"}),(0,b.jsx)("span",{className:`flex-1 truncate ${l?"line-through text-slate-400":"text-slate-500"}`,children:a.memo||a.transactionType}),l&&(0,b.jsx)("span",{className:"bg-amber-200 text-amber-800 text-xs px-2 py-0.5 rounded-full flex-shrink-0",children:j.subAccount}),(0,b.jsx)("span",{className:`font-mono text-right w-24 flex-shrink-0
          ${l?"line-through text-slate-400":a.amount<0?"text-red-600":"text-slate-700"}
        `,children:(0,h.formatCurrency)(a.amount)}),l?(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),f({type:"UNTAG_TRANSACTION",payload:a.id})},className:"text-xs text-red-600 hover:text-red-800 px-2 py-1 rounded hover:bg-red-50 flex-shrink-0",children:"Untag"}):(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),i(!0)},className:"text-xs text-blue-600 hover:text-blue-800 px-2 py-1 rounded hover:bg-blue-50 flex-shrink-0",children:"Tag"})]}),g&&(0,b.jsx)(k,{transaction:a,onClose:()=>i(!1)})]})}function m({row:a,months:g,depth:i=0,isChild:k=!1}){let{state:n,dispatch:o}=(0,c.usePL)(),{expandedAccounts:p,expandedMonths:q,transactions:r,accounts:s,tags:t}=n,u=p.has(a.accountCode),v=a.account.children.length>0,w=a.transactionCount>0,x=v||w,y=(0,d.useMemo)(()=>u&&v?a.account.children.map(a=>{let b=s.get(a);if(!b)return null;let{monthlyAmounts:c,ytdTotal:d,transactionCount:e}=f(a,r,s,g,t);return 0===d&&0===e?null:{accountCode:a,account:b,monthlyAmounts:c,ytdTotal:d,transactionCount:e}}).filter(a=>null!==a):[],[u,v,a.account.children,s,r,g,t]),z=(0,d.useMemo)(()=>{if(!u||v)return{};var b=e(a.accountCode,r,s,t);let c={};for(let a of b)c[a.month]||(c[a.month]=[]),c[a.month].push(a);for(let a of Object.keys(c))c[a].sort((a,b)=>{let c=new Date(a.transactionDate),d=new Date(b.transactionDate);return c.getTime()-d.getTime()});return c},[u,v,a.accountCode,r,s,t]),A=20*i;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("tr",{className:`
          ${k?"bg-slate-50/50":"bg-white"}
          ${x?"cursor-pointer hover:bg-slate-100":""}
          border-b border-slate-100
        `,onClick:()=>{x&&o({type:"TOGGLE_ACCOUNT",payload:a.accountCode})},children:[(0,b.jsx)("td",{className:"sticky left-0 bg-inherit px-3 py-2 font-medium text-slate-900 whitespace-nowrap z-10",style:{paddingLeft:`${12+A}px`},children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[x?(0,b.jsx)(j,{expanded:u,className:"text-slate-400 flex-shrink-0"}):(0,b.jsx)("span",{className:"w-4"}),(0,b.jsx)("span",{className:i>0?"text-sm":"",children:a.account.name})]})}),g.map(c=>(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm whitespace-nowrap
              ${a.monthlyAmounts[c]<0?"text-red-600":"text-slate-700"}
            `,children:0!==a.monthlyAmounts[c]?(0,h.formatCurrency)(a.monthlyAmounts[c]):"-"},c)),(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm font-semibold whitespace-nowrap
            ${a.ytdTotal<0?"text-red-600":"text-slate-900"}
          `,children:(0,h.formatCurrency)(a.ytdTotal)})]}),u&&y.map(a=>(0,b.jsx)(m,{row:a,months:g,depth:i+1,isChild:!0},a.accountCode)),u&&!v&&Object.keys(z).length>0&&(0,b.jsx)(b.Fragment,{children:g.filter(a=>z[a]?.length>0).map(c=>{let d=z[c]||[],e=q.has(`${a.accountCode}-${c}`);return(0,b.jsx)("tr",{className:"bg-slate-50",children:(0,b.jsxs)("td",{colSpan:g.length+2,className:"px-3 py-1",style:{paddingLeft:`${32+A}px`},children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600 cursor-pointer hover:text-slate-900",onClick:b=>{b.stopPropagation(),o({type:"TOGGLE_MONTH",payload:`${a.accountCode}-${c}`})},children:[(0,b.jsx)(j,{expanded:e,className:"text-slate-400"}),(0,b.jsx)("span",{className:"font-medium",children:(0,h.formatMonth)(c)}),(0,b.jsxs)("span",{className:"text-slate-400",children:["(",d.length," transactions)"]}),(0,b.jsx)("span",{className:"ml-auto font-mono",children:(0,h.formatCurrency)(d.reduce((a,b)=>a+b.amount,0))})]}),e&&(0,b.jsx)("div",{className:"mt-2 space-y-1 pb-2",children:d.map(a=>(0,b.jsx)(l,{transaction:a},a.id))})]})},`${a.accountCode}-${c}-group`)})})]})}function n({section:a,title:e,colorClass:i}){let{state:j}=(0,c.usePL)(),{transactions:k,accounts:l,months:n,tags:o}=j,p=(0,d.useMemo)(()=>{if(0===k.length)return[];let b=[];for(let c of Array.from(l.values()).filter(b=>b.section===a&&null===b.parentCode).sort((a,b)=>a.code.localeCompare(b.code))){let{monthlyAmounts:a,ytdTotal:d,transactionCount:e}=f(c.code,k,l,n,o);(0!==d||e>0)&&b.push({accountCode:c.code,account:c,monthlyAmounts:a,ytdTotal:d,transactionCount:e})}return b},[a,k,l,n,o]),q=(0,d.useMemo)(()=>{let b={},c=0;return n.forEach(d=>{let e=g(a,k,l,d,o);b[d]=e,c+=e}),{monthly:b,ytd:c}},[a,k,l,n,o]);return 0===p.length?null:(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:`w-1 h-6 rounded ${i}`}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:e})]}),(0,b.jsx)("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:(0,b.jsxs)("table",{className:"w-full min-w-max",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-slate-50 border-b border-slate-200",children:[(0,b.jsx)("th",{className:"sticky left-0 bg-slate-50 px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:"Account"}),n.map(a=>(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,h.formatMonth)(a)},a)),(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-28 bg-slate-100",children:"YTD Total"})]})}),(0,b.jsxs)("tbody",{children:[p.map(a=>(0,b.jsx)(m,{row:a,months:n},a.accountCode)),(0,b.jsxs)("tr",{className:`${i.replace("bg-","bg-opacity-10 bg-")} border-t-2 border-slate-300`,children:[(0,b.jsxs)("td",{className:"sticky left-0 bg-inherit px-3 py-2 font-bold text-slate-900",children:["Total ",e]}),n.map(a=>(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm font-bold
                    ${q.monthly[a]<0?"text-red-600":"text-slate-900"}
                  `,children:(0,h.formatCurrency)(q.monthly[a])},a)),(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm font-bold bg-slate-100
                  ${q.ytd<0?"text-red-600":"text-slate-900"}
                `,children:(0,h.formatCurrency)(q.ytd)})]})]})]})})]})}function o({type:a}){let{state:e}=(0,c.usePL)(),{transactions:f,accounts:i,months:j,tags:k}=e,l=(0,d.useMemo)(()=>{let a={},b={},c={},d={},e={},h=0,l=0,m=0,n=0,o=0;j.forEach(j=>{a[j]=g("revenue",f,i,j,k),b[j]=g("cogs",f,i,j,k),c[j]=g("costOfSales",f,i,j,k),d[j]=g("operatingExpenses",f,i,j,k),e[j]=g("otherIncome",f,i,j,k),h+=a[j],l+=b[j],m+=c[j],n+=d[j],o+=e[j]});let p={},q={},r=0,s=0;return j.forEach(f=>{p[f]=a[f]-b[f]-c[f],q[f]=p[f]-d[f]+e[f],r+=p[f],s+=q[f]}),{grossProfit:{monthly:p,ytd:r},netIncome:{monthly:q,ytd:s},revenue:{monthly:a,ytd:h}}},[f,i,j,k]);if(0===f.length)return null;let m="grossProfit"===a?l.grossProfit:l.netIncome,n="grossProfit"===a?"bg-blue-50":"bg-green-50",o="grossProfit"===a?"border-blue-200":"border-green-200",p=0!==l.revenue.ytd?m.ytd/l.revenue.ytd*100:0;return(0,b.jsx)("div",{className:`mb-6 overflow-x-auto border ${o} rounded-lg`,children:(0,b.jsxs)("table",{className:"w-full min-w-max",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:`${n} border-b ${o}`,children:[(0,b.jsx)("th",{className:"sticky left-0 bg-inherit px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:" "}),j.map(a=>(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,h.formatMonth)(a)},a)),(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-28",children:"YTD Total"})]})}),(0,b.jsx)("tbody",{children:(0,b.jsxs)("tr",{className:n,children:[(0,b.jsxs)("td",{className:"sticky left-0 bg-inherit px-3 py-3 font-bold text-lg text-slate-900",children:["grossProfit"===a?"Gross Profit":"Net Income",(0,b.jsxs)("span",{className:"ml-2 text-sm font-normal text-slate-500",children:["(",p.toFixed(1),"% margin)"]})]}),j.map(a=>(0,b.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg
                  ${m.monthly[a]<0?"text-red-600":"text-slate-900"}
                `,children:(0,h.formatCurrency)(m.monthly[a])},a)),(0,b.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg
                ${m.ytd<0?"text-red-600":"text-slate-900"}
              `,children:(0,h.formatCurrency)(m.ytd)})]})})]})})}let p={Sales:["4000","4030"],Discounts:["4010"],Refunds:["4020"],Chargebacks:["4040"]},q={"Product Costs + Shipping":["5000","5010","5030","5040","5050"]},r={"Google Ads":{accounts:["6110"],filter:a=>a.name.toLowerCase().includes("google")},"Facebook Ads":{accounts:["6110"],filter:a=>a.name.toLowerCase().includes("facebook")||a.name.toLowerCase().includes("facebk")},"Other Paid Ads":{accounts:["6110"],filter:a=>!a.name.toLowerCase().includes("google")&&!a.name.toLowerCase().includes("facebook")&&!a.name.toLowerCase().includes("facebk")},"Processing Fees":{accounts:["6055","6065","6075"]},"Affiliate / Creator Payouts":{accounts:["6120","6125"]},"Marketing Agencies":{accounts:["6130"]},"Shopify Apps":{accounts:["6070"]},"Marketing Software":{accounts:["6140"]},"Fulfillment (3PL + Shipping)":{accounts:["6010","6020","6035"]},"Virtual Assistants / Contractors":{accounts:["6240"]},"Other Software":{accounts:["6375"]},Accounting:{accounts:["6330"]},"Other Expenses":{accounts:["6100","6150","6210","6250","6260","6290","6300","6320","6390","6410","6450","6470","6495"]}};function s(){let{state:a}=(0,c.usePL)(),{transactions:e,months:f,tags:g}=a,{income:i,cogs:j,expenses:k}=(0,d.useMemo)(()=>0===e.length?{income:[],cogs:[],expenses:[]}:function(a,b,c){let d=a.filter(a=>!b[a.id]),e=(a,b)=>{let e={};c.forEach(a=>{e[a]=0});let f=0;for(let c of d)a.includes(c.accountCode)&&(!b||b(c))&&void 0!==e[c.month]&&(e[c.month]+=c.amount,f+=c.amount);return{monthly:e,ytd:f}},f=[],g={},h=0;for(let[a,b]of(c.forEach(a=>{g[a]=0}),Object.entries(p))){let{monthly:d,ytd:i}=e(b);f.push({label:a,monthlyAmounts:d,ytd:i}),c.forEach(a=>{g[a]+=d[a]}),h+=i}f.push({label:"Total Income",monthlyAmounts:g,ytd:h,isTotal:!0,isBold:!0});let i=[],j={},k=0;for(let[a,b]of(c.forEach(a=>{j[a]=0}),Object.entries(q))){let{monthly:d,ytd:f}=e(b);i.push({label:a,monthlyAmounts:d,ytd:f}),c.forEach(a=>{j[a]+=d[a]}),k+=f}let l={};c.forEach(a=>{l[a]=g[a]-j[a]});let m=h-k;i.push({label:"Gross Profit",monthlyAmounts:l,ytd:m,isTotal:!0,isBold:!0});let n=[],o={},s=0;for(let[a,b]of(c.forEach(a=>{o[a]=0}),Object.entries(r))){let{monthly:d,ytd:f}=e("accounts"in b?b.accounts:b,"filter"in b?b.filter:void 0);0!==f&&(n.push({label:a,monthlyAmounts:d,ytd:f,indent:1}),c.forEach(a=>{o[a]+=d[a]}),s+=f)}n.push({label:"Total Expenses",monthlyAmounts:o,ytd:s,isTotal:!0,isBold:!0});let t={};c.forEach(a=>{t[a]=l[a]-o[a]});let u=m-s;return n.push({label:"Net Profit",monthlyAmounts:t,ytd:u,isTotal:!0,isBold:!0}),{income:f,cogs:i,expenses:n}}(e,g,f),[e,g,f]);if(0===e.length)return null;let l=(a,c,d,e)=>(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:`w-1 h-6 rounded ${d}`}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:a})]}),(0,b.jsx)("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:(0,b.jsxs)("table",{className:"w-full min-w-max",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-slate-50 border-b border-slate-200",children:[(0,b.jsx)("th",{className:"sticky left-0 bg-slate-50 px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:"Account"}),f.map(a=>(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,h.formatMonth)(a)},a)),(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-28 bg-slate-100",children:"YTD Total"})]})}),(0,b.jsx)("tbody",{children:c.map((a,c)=>(0,b.jsxs)("tr",{className:`
                  ${a.isTotal?`${e} border-t-2 border-slate-300`:"border-b border-slate-100 hover:bg-slate-50"}
                `,children:[(0,b.jsx)("td",{className:`sticky left-0 bg-inherit px-3 py-2 text-slate-900 ${a.isBold?"font-bold":""} ${a.indent?"pl-6":""}`,children:a.label}),f.map(c=>(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm
                      ${a.isBold?"font-bold":""}
                      ${a.monthlyAmounts[c]<0?"text-red-600":"text-slate-900"}
                    `,children:(0,h.formatCurrency)(a.monthlyAmounts[c])},c)),(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm bg-slate-100
                    ${a.isBold?"font-bold":""}
                    ${a.ytd<0?"text-red-600":"text-slate-900"}
                  `,children:(0,h.formatCurrency)(a.ytd)})]},c))})]})})]}),m=j.find(a=>"Gross Profit"===a.label),n=k.find(a=>"Net Profit"===a.label),o=j.filter(a=>"Gross Profit"!==a.label),s=k.filter(a=>"Net Profit"!==a.label),t=(a,c,d,e)=>{if(!a)return null;let g=i[i.length-1]?.ytd!==0?a.ytd/i[i.length-1].ytd*100:0;return(0,b.jsx)("div",{className:`mb-6 overflow-x-auto border ${e} rounded-lg`,children:(0,b.jsxs)("table",{className:"w-full min-w-max",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:`${d} border-b ${e}`,children:[(0,b.jsx)("th",{className:"sticky left-0 bg-inherit px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:" "}),f.map(a=>(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,h.formatMonth)(a)},a)),(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-28",children:"YTD Total"})]})}),(0,b.jsx)("tbody",{children:(0,b.jsxs)("tr",{className:d,children:[(0,b.jsxs)("td",{className:"sticky left-0 bg-inherit px-3 py-3 font-bold text-lg text-slate-900",children:[c,(0,b.jsxs)("span",{className:"ml-2 text-sm font-normal text-slate-500",children:["(",g.toFixed(1),"% margin)"]})]}),f.map(c=>(0,b.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg
                    ${a.monthlyAmounts[c]<0?"text-red-600":"text-slate-900"}
                  `,children:(0,h.formatCurrency)(a.monthlyAmounts[c])},c)),(0,b.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg
                  ${a.ytd<0?"text-red-600":"text-slate-900"}
                `,children:(0,h.formatCurrency)(a.ytd)})]})})]})})};return(0,b.jsxs)("div",{children:[l("Income",i,"bg-emerald-500","bg-emerald-50"),l("Cost of Goods",o,"bg-orange-500","bg-orange-50"),t(m,"Gross Profit","bg-blue-50","border-blue-200"),l("Expenses",s,"bg-red-500","bg-red-50"),t(n,"Net Profit","bg-green-50","border-green-200")]})}function t(){let{state:a}=(0,c.usePL)(),[e,f]=(0,d.useState)(!1),[g,i]=(0,d.useState)(new Set),k=(0,d.useMemo)(()=>{let b={};for(let c of a.exclusions)b[c.category]||(b[c.category]={exclusions:[],total:0,justification:c.justification}),b[c.category].exclusions.push(c),b[c.category].total+=c.amount;return b},[a.exclusions]),l=(0,d.useMemo)(()=>a.exclusions.reduce((a,b)=>a+b.amount,0),[a.exclusions]),m=Object.keys(k).sort();return 0===a.exclusions.length?null:(0,b.jsxs)("div",{className:"mt-8 pt-6 border-t-2 border-slate-300",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4 cursor-pointer hover:opacity-80",onClick:()=>f(!e),children:[(0,b.jsx)(j,{expanded:e,className:"text-slate-400"}),(0,b.jsx)("div",{className:"w-1 h-6 rounded bg-amber-500"}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Exclusions"}),(0,b.jsxs)("span",{className:"text-sm text-slate-500",children:["(",a.exclusions.length," items excluded from P&L)"]}),(0,b.jsx)("span",{className:"ml-auto font-mono font-semibold text-slate-700",children:(0,h.formatCurrency)(l)})]}),e&&(0,b.jsxs)("div",{className:"space-y-3 pl-6",children:[(0,b.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"The following expenses have been excluded as non-recurring or owner-related items that would not transfer to a buyer."}),m.map(a=>{let c=k[a],d=g.has(a);return(0,b.jsxs)("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 bg-slate-50 cursor-pointer hover:bg-slate-100",onClick:()=>{let b;(b=new Set(g)).has(a)?b.delete(a):b.add(a),i(b)},children:[(0,b.jsx)(j,{expanded:d,className:"text-slate-400"}),(0,b.jsx)("div",{className:`w-2 h-2 rounded-full ${{Personal:"bg-purple-500",Discretionary:"bg-purple-400","Owner Travel":"bg-blue-500","Owner Education":"bg-blue-400","Owner Tools":"bg-blue-300","Owner Expense":"bg-blue-600",Legal:"bg-red-500","Legal/Tax":"bg-red-400","One-Time Project":"bg-amber-500","One-Time COGS":"bg-amber-400","Terminated Agency":"bg-orange-500","Terminated Contractor":"bg-orange-400","Terminated Service":"bg-orange-300","M&A Process":"bg-slate-500"}[a]||"bg-slate-400"}`}),(0,b.jsx)("span",{className:"font-semibold text-slate-900",children:a}),(0,b.jsxs)("span",{className:"text-sm text-slate-500",children:["(",c.exclusions.length," items)"]}),(0,b.jsx)("span",{className:"ml-auto text-xs text-slate-500 max-w-md truncate",children:c.justification}),(0,b.jsx)("span",{className:"font-mono font-semibold text-slate-700 ml-4",children:(0,h.formatCurrency)(c.total)})]}),d&&(0,b.jsx)("div",{className:"divide-y divide-slate-100",children:c.exclusions.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-4 px-6 py-2 bg-white text-sm hover:bg-slate-50",children:[(0,b.jsx)("span",{className:"text-slate-400 w-24",children:a.date}),(0,b.jsx)("span",{className:"text-slate-700 flex-1 truncate",children:a.vendor||a.memo?.substring(0,40)||"Unknown"}),(0,b.jsx)("span",{className:"text-slate-500 text-xs w-32 truncate",children:a.account.replace(/^\d{4}\s+/,"")}),(0,b.jsx)("span",{className:"font-mono text-slate-600 w-24 text-right",children:(0,h.formatCurrency)(a.amount)})]},`${a.date}-${a.amount}-${c}`))})]},a)})]})]})}function u(){let{state:a,dispatch:d}=(0,c.usePL)();return a.loading?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsxs)("div",{className:"flex items-center gap-3 text-slate-500",children:[(0,b.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,b.jsx)("span",{children:"Loading financial data..."})]})}):a.error?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsxs)("div",{className:"text-red-600 bg-red-50 px-6 py-4 rounded-lg border border-red-200",children:[(0,b.jsx)("strong",{children:"Error:"})," ",a.error]})}):(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"flex items-center justify-end mb-4",children:(0,b.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,b.jsx)("span",{className:`text-sm font-medium ${a.khBrokersView?"text-slate-400":"text-slate-900"}`,children:"Detailed View"}),(0,b.jsx)("button",{onClick:()=>{d({type:"TOGGLE_KH_BROKERS_VIEW"})},className:`relative w-14 h-7 rounded-full transition-colors duration-200 ${a.khBrokersView?"bg-emerald-500":"bg-slate-300"}`,children:(0,b.jsx)("span",{className:`absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform duration-200 ${a.khBrokersView?"translate-x-8":"translate-x-1"}`})}),(0,b.jsx)("span",{className:`text-sm font-medium ${a.khBrokersView?"text-slate-900":"text-slate-400"}`,children:"KH Brokers View"})]})}),(0,b.jsx)(i,{}),a.khBrokersView?(0,b.jsx)(s,{}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n,{section:"revenue",title:"Revenue",colorClass:"bg-emerald-500"}),(0,b.jsx)(n,{section:"cogs",title:"Cost of Goods Sold",colorClass:"bg-orange-500"}),(0,b.jsx)(n,{section:"costOfSales",title:"Cost of Sales",colorClass:"bg-amber-500"}),(0,b.jsx)(o,{type:"grossProfit"}),(0,b.jsx)(n,{section:"operatingExpenses",title:"Operating Expenses",colorClass:"bg-red-500"}),(0,b.jsx)(o,{type:"netIncome"})]}),(0,b.jsx)(t,{})]})}a.s(["PLViewer",()=>u],7839)}];

//# sourceMappingURL=spicy-pnl_src_components_pnl_PLViewer_tsx_a77abb16._.js.map