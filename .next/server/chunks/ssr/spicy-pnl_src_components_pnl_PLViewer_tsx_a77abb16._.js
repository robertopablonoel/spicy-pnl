module.exports=[7839,a=>{"use strict";var b=a.i(82332),c=a.i(1163),d=a.i(55005),e=a.i(69264),f=a.i(46726);function g(){let{state:a}=(0,c.usePL)(),g=(0,d.useMemo)(()=>0===a.transactions.length?null:(0,e.calculatePLSummary)(a.transactions,a.accounts,a.tags),[a.transactions,a.accounts,a.tags]);if(!g)return null;let h=[{label:"Net Revenue",value:g.netRevenue,color:"bg-blue-50 border-blue-200",textColor:"text-blue-700",valueColor:"text-blue-900"},{label:"Net Income",value:g.netIncome,subLabel:`${g.netMargin.toFixed(1)}% margin`,color:g.netIncome>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200",textColor:g.netIncome>=0?"text-green-700":"text-red-700",valueColor:g.netIncome>=0?"text-green-900":"text-red-900"}];return(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:h.map(a=>(0,b.jsxs)("div",{className:`${a.color} border rounded-xl p-5 shadow-sm transition-shadow hover:shadow-md`,children:[(0,b.jsx)("div",{className:`text-sm font-medium ${a.textColor} uppercase tracking-wide`,children:a.label}),(0,b.jsx)("div",{className:`text-3xl font-bold ${a.valueColor} mt-2 font-mono`,children:(0,f.formatCurrency)(a.value)}),a.subLabel&&(0,b.jsx)("div",{className:`text-sm ${a.textColor} mt-2 opacity-80`,children:a.subLabel})]},a.label))})}function h({expanded:a,className:c=""}){return(0,b.jsx)("svg",{className:`w-4 h-4 transition-transform duration-200 ${a?"rotate-90":""} ${c}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}function i({transaction:a,onClose:e}){let{state:g,dispatch:h}=(0,c.usePL)(),[i,j]=(0,d.useState)("personal"),[k,l]=(0,d.useState)(""),[m,n]=(0,d.useState)(!1),o=b=>{h({type:"TAG_TRANSACTION",payload:{transactionId:a.id,tag:{category:i,subAccount:b,taggedAt:Date.now()}}}),e()},p=()=>{k.trim()&&(h({type:"ADD_SUB_ACCOUNT",payload:{category:i,name:k.trim()}}),o(k.trim()))},q=g.tagConfig[i];return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:e,children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"px-4 py-3 border-b border-slate-200",children:[(0,b.jsx)("h3",{className:"font-semibold text-slate-900",children:"Tag Transaction"}),(0,b.jsxs)("p",{className:"text-sm text-slate-500 mt-1 truncate",children:[a.name||a.memo," - ",(0,f.formatCurrency)(a.amount)]})]}),(0,b.jsxs)("div",{className:"flex border-b border-slate-200",children:[(0,b.jsx)("button",{className:`flex-1 px-4 py-2 text-sm font-medium border-b-2 transition-colors
              ${"personal"===i?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700"}
            `,onClick:()=>j("personal"),children:"Personal"}),(0,b.jsx)("button",{className:`flex-1 px-4 py-2 text-sm font-medium border-b-2 transition-colors
              ${"nonRecurring"===i?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700"}
            `,onClick:()=>j("nonRecurring"),children:"Non-Recurring"})]}),(0,b.jsx)("div",{className:"p-4 max-h-64 overflow-y-auto",children:(0,b.jsxs)("div",{className:"space-y-2",children:[q.map(a=>(0,b.jsx)("button",{onClick:()=>o(a),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100 text-slate-700 transition-colors",children:a},a)),m?(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"text",value:k,onChange:a=>l(a.target.value),placeholder:"Enter name...",className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0,onKeyDown:a=>{"Enter"===a.key&&p(),"Escape"===a.key&&n(!1)}}),(0,b.jsx)("button",{onClick:p,disabled:!k.trim(),className:"px-3 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add"})]}):(0,b.jsxs)("button",{onClick:()=>n(!0),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-blue-50 text-blue-600 transition-colors flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add new sub-account"]})]})}),(0,b.jsx)("div",{className:"px-4 py-3 border-t border-slate-200 flex justify-end",children:(0,b.jsx)("button",{onClick:e,className:"px-4 py-2 text-sm text-slate-600 hover:text-slate-800",children:"Cancel"})})]})})}function j({transaction:a}){let{state:e,dispatch:g}=(0,c.usePL)(),[h,j]=(0,d.useState)(!1),k=e.tags[a.id],l=!!k;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:`
          flex items-center gap-3 py-1.5 px-2 rounded text-sm
          ${l?"bg-amber-50 opacity-60":"bg-white hover:bg-slate-50"}
        `,children:[(0,b.jsx)("span",{className:"text-slate-400 font-mono text-xs w-12 flex-shrink-0",children:(a=>{let[b,c]=a.split("/");return`${b}/${c}`})(a.transactionDate)}),(0,b.jsx)("span",{className:`font-medium w-32 flex-shrink-0 truncate ${l?"line-through text-slate-400":"text-slate-700"}`,children:a.name||"-"}),(0,b.jsx)("span",{className:`flex-1 truncate ${l?"line-through text-slate-400":"text-slate-500"}`,children:a.memo||a.transactionType}),l&&(0,b.jsx)("span",{className:"bg-amber-200 text-amber-800 text-xs px-2 py-0.5 rounded-full flex-shrink-0",children:k.subAccount}),(0,b.jsx)("span",{className:`font-mono text-right w-24 flex-shrink-0
          ${l?"line-through text-slate-400":a.amount<0?"text-red-600":"text-slate-700"}
        `,children:(0,f.formatCurrency)(a.amount)}),l?(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),g({type:"UNTAG_TRANSACTION",payload:a.id})},className:"text-xs text-red-600 hover:text-red-800 px-2 py-1 rounded hover:bg-red-50 flex-shrink-0",children:"Untag"}):(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),j(!0)},className:"text-xs text-blue-600 hover:text-blue-800 px-2 py-1 rounded hover:bg-blue-50 flex-shrink-0",children:"Tag"})]}),h&&(0,b.jsx)(i,{transaction:a,onClose:()=>j(!1)})]})}function k({row:a,months:g,depth:i=0,isChild:l=!1,allowDrillDown:m=!0}){let{state:n,dispatch:o}=(0,c.usePL)(),{expandedAccounts:p,expandedMonths:q,transactions:r,accounts:s,tags:t}=n,u=m&&p.has(a.accountCode),v=a.account.children.length>0,w=a.transactionCount>0,x=m&&(v||w),y=(0,d.useMemo)(()=>u&&v?a.account.children.map(a=>{let b=s.get(a);if(!b)return null;let{monthlyAmounts:c,ytdTotal:d,transactionCount:f}=(0,e.calculateMonthlyAmounts)(a,r,s,g,t);return 0===d&&0===f?null:{accountCode:a,account:b,monthlyAmounts:c,ytdTotal:d,transactionCount:f}}).filter(a=>null!==a):[],[u,v,a.account.children,s,r,g,t]),z=(0,d.useMemo)(()=>{if(!u||v)return{};let b=(0,e.getAccountTransactions)(a.accountCode,r,s,t);return(0,e.groupTransactionsByMonth)(b)},[u,v,a.accountCode,r,s,t]),A=20*i;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("tr",{className:`
          ${l?"bg-slate-50/50":"bg-white"}
          ${x?"cursor-pointer hover:bg-slate-100":""}
          border-b border-slate-100
        `,onClick:()=>{x&&o({type:"TOGGLE_ACCOUNT",payload:a.accountCode})},children:[(0,b.jsx)("td",{className:"sticky left-0 bg-inherit px-3 py-2 font-medium text-slate-900 whitespace-nowrap z-10",style:{paddingLeft:`${12+A}px`},children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[x?(0,b.jsx)(h,{expanded:u,className:"text-slate-400 flex-shrink-0"}):(0,b.jsx)("span",{className:"w-4"}),(0,b.jsx)("span",{className:i>0?"text-sm":"",children:a.account.name})]})}),g.map(c=>(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm whitespace-nowrap
              ${a.monthlyAmounts[c]<0?"text-red-600":"text-slate-700"}
            `,children:0!==a.monthlyAmounts[c]?(0,f.formatCurrency)(a.monthlyAmounts[c]):"-"},c)),(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm font-semibold whitespace-nowrap bg-violet-50 border-l-2 border-violet-200
            ${a.ytdTotal<0?"text-red-600":"text-violet-900"}
          `,children:(0,f.formatCurrency)(a.ytdTotal)})]}),u&&y.map(a=>(0,b.jsx)(k,{row:a,months:g,depth:i+1,isChild:!0,allowDrillDown:m},a.accountCode)),u&&!v&&Object.keys(z).length>0&&(0,b.jsx)(b.Fragment,{children:g.filter(a=>z[a]?.length>0).map(c=>{let d=z[c]||[],e=q.has(`${a.accountCode}-${c}`);return(0,b.jsx)("tr",{className:"bg-slate-50",children:(0,b.jsxs)("td",{colSpan:g.length+2,className:"px-3 py-1",style:{paddingLeft:`${32+A}px`},children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600 cursor-pointer hover:text-slate-900",onClick:b=>{b.stopPropagation(),o({type:"TOGGLE_MONTH",payload:`${a.accountCode}-${c}`})},children:[(0,b.jsx)(h,{expanded:e,className:"text-slate-400"}),(0,b.jsx)("span",{className:"font-medium",children:(0,f.formatMonth)(c)}),(0,b.jsxs)("span",{className:"text-slate-400",children:["(",d.length," transactions)"]}),(0,b.jsx)("span",{className:"ml-auto font-mono",children:(0,f.formatCurrency)(d.reduce((a,b)=>a+b.amount,0))})]}),e&&(0,b.jsx)("div",{className:"mt-2 space-y-1 pb-2",children:d.map(a=>(0,b.jsx)(j,{transaction:a},a.id))})]})},`${a.accountCode}-${c}-group`)})})]})}function l({section:a,title:g,colorClass:h,totalColorClass:i,allowDrillDown:j=!0}){let{state:l}=(0,c.usePL)(),{transactions:m,accounts:n,months:o,tags:p}=l,q=(0,d.useMemo)(()=>0===m.length?[]:(0,e.buildPLRows)(a,m,n,o,p),[a,m,n,o,p]),r=(0,d.useMemo)(()=>{let b={},c=0;return o.forEach(d=>{let f=(0,e.calculateSectionMonthlyTotal)(a,m,n,d,p);b[d]=f,c+=f}),{monthly:b,ytd:c}},[a,m,n,o,p]);return 0===q.length?null:(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:`w-1.5 h-6 rounded-full ${h}`}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-800",children:g})]}),(0,b.jsx)("div",{className:"overflow-x-auto border border-slate-200 rounded-xl shadow-sm bg-white",children:(0,b.jsxs)("table",{className:"w-full min-w-max",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-slate-50 border-b border-slate-200",children:[(0,b.jsx)("th",{className:"sticky left-0 bg-slate-50 px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:"Account"}),o.map(a=>(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,f.formatMonth)(a)},a)),(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-violet-700 uppercase tracking-wider w-28 bg-violet-100 border-l-2 border-violet-200",children:"YTD Total"})]})}),(0,b.jsxs)("tbody",{children:[q.map(a=>(0,b.jsx)(k,{row:a,months:o,allowDrillDown:j},a.accountCode)),(0,b.jsxs)("tr",{className:`${i||"bg-slate-50"} border-t-2 border-slate-300`,children:[(0,b.jsxs)("td",{className:"sticky left-0 bg-inherit px-3 py-2 font-bold text-slate-900",children:["Total ",g]}),o.map(a=>(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm font-bold
                    ${r.monthly[a]<0?"text-red-600":"text-slate-900"}
                  `,children:(0,f.formatCurrency)(r.monthly[a])},a)),(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm font-bold bg-violet-100 border-l-2 border-violet-200
                  ${r.ytd<0?"text-red-600":"text-violet-900"}
                `,children:(0,f.formatCurrency)(r.ytd)})]})]})]})})]})}function m({type:a}){let{state:g}=(0,c.usePL)(),{transactions:h,accounts:i,months:j,tags:k}=g,l=(0,d.useMemo)(()=>{let a={},b={},c={},d={},f={},g=0,l=0,m=0,n=0,o=0;j.forEach(j=>{a[j]=(0,e.calculateSectionMonthlyTotal)("revenue",h,i,j,k),b[j]=(0,e.calculateSectionMonthlyTotal)("cogs",h,i,j,k),c[j]=(0,e.calculateSectionMonthlyTotal)("costOfSales",h,i,j,k),d[j]=(0,e.calculateSectionMonthlyTotal)("operatingExpenses",h,i,j,k),f[j]=(0,e.calculateSectionMonthlyTotal)("otherIncome",h,i,j,k),g+=a[j],l+=b[j],m+=c[j],n+=d[j],o+=f[j]});let p={},q={},r=0,s=0;return j.forEach(e=>{p[e]=a[e]-b[e]-c[e],q[e]=p[e]-d[e]+f[e],r+=p[e],s+=q[e]}),{grossProfit:{monthly:p,ytd:r},netIncome:{monthly:q,ytd:s},revenue:{monthly:a,ytd:g}}},[h,i,j,k]);if(0===h.length)return null;let m="grossProfit"===a?l.grossProfit:l.netIncome,n="grossProfit"===a?"bg-blue-50":"bg-green-50",o="grossProfit"===a?"border-blue-200":"border-green-200",p=0!==l.revenue.ytd?m.ytd/l.revenue.ytd*100:0;return(0,b.jsx)("div",{className:`mb-8 overflow-x-auto border ${o} rounded-xl shadow-sm`,children:(0,b.jsxs)("table",{className:"w-full min-w-max",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:`${n} border-b ${o}`,children:[(0,b.jsx)("th",{className:"sticky left-0 bg-inherit px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:" "}),j.map(a=>(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,f.formatMonth)(a)},a)),(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-violet-700 uppercase tracking-wider w-28 bg-violet-100 border-l-2 border-violet-200",children:"YTD Total"})]})}),(0,b.jsx)("tbody",{children:(0,b.jsxs)("tr",{className:n,children:[(0,b.jsxs)("td",{className:"sticky left-0 bg-inherit px-3 py-3 font-bold text-lg text-slate-900",children:["grossProfit"===a?"Gross Profit":"Net Income",(0,b.jsxs)("span",{className:"ml-2 text-sm font-normal text-slate-500",children:["(",p.toFixed(1),"% margin)"]})]}),j.map(a=>(0,b.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg
                  ${m.monthly[a]<0?"text-red-600":"text-slate-900"}
                `,children:(0,f.formatCurrency)(m.monthly[a])},a)),(0,b.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg bg-violet-100 border-l-2 border-violet-200
                ${m.ytd<0?"text-red-600":"text-violet-900"}
              `,children:(0,f.formatCurrency)(m.ytd)})]})})]})})}let n={Sales:["4000","4030"],Discounts:["4010"],Refunds:["4020"],Chargebacks:["4040"]},o={"Product Costs":["5000","5030","5040","5050"],"Shipping & Fulfillment":["5010","6010","6020","6035"]},p={"Google Ads":{accounts:["6110"],filter:a=>a.name.toLowerCase().includes("google")},"Facebook Ads":{accounts:["6110"],filter:a=>a.name.toLowerCase().includes("facebook")||a.name.toLowerCase().includes("facebk")},"Other Paid Ads":{accounts:["6110"],filter:a=>!a.name.toLowerCase().includes("google")&&!a.name.toLowerCase().includes("facebook")&&!a.name.toLowerCase().includes("facebk")},"Processing Fees":{accounts:["6055","6065","6075"]},"Affiliate / Creator Payouts":{accounts:["6120","6125"]},"Marketing Agencies":{accounts:["6130"]},"Shopify Apps":{accounts:["6070"]},"Marketing Software":{accounts:["6140"]},"Virtual Assistants / Contractors":{accounts:["6240"]},"Other Software":{accounts:["6375"]},Accounting:{accounts:["6330"]},"Other Expenses":{accounts:["6100","6150","6210","6250","6260","6290","6300","6320","6390","6410","6450","6470","6495"]}};function q({item:a,months:c,totalColorClass:e,allowDrillDown:g=!0}){let[i,k]=(0,d.useState)(!1),[l,m]=(0,d.useState)(new Set),n=a.transactions&&a.transactions.length>0,o=g&&n&&!a.isTotal,p=(0,d.useMemo)(()=>{if(!a.transactions)return{};var b=a.transactions;let c={};for(let a of b)c[a.month]||(c[a.month]=[]),c[a.month].push(a);return c},[a.transactions]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("tr",{className:`
          ${a.isTotal?`${e} border-t-2 border-slate-300`:"border-b border-slate-100"}
          ${o?"cursor-pointer hover:bg-slate-100":""}
        `,onClick:()=>{o&&k(!i)},children:[(0,b.jsx)("td",{className:`sticky left-0 bg-inherit px-3 py-2 text-slate-900 ${a.isBold?"font-bold":""} ${a.indent?"pl-6":""}`,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[o?(0,b.jsx)(h,{expanded:i,className:"text-slate-400 flex-shrink-0"}):(0,b.jsx)("span",{className:"w-4"}),(0,b.jsx)("span",{children:a.label})]})}),c.map(c=>(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm
              ${a.isBold?"font-bold":""}
              ${a.monthlyAmounts[c]<0?"text-red-600":"text-slate-900"}
            `,children:(0,f.formatCurrency)(a.monthlyAmounts[c])},c)),(0,b.jsx)("td",{className:`px-3 py-2 text-right font-mono text-sm bg-violet-50 border-l-2 border-violet-200
            ${a.isBold?"font-bold":""}
            ${a.ytd<0?"text-red-600":"text-violet-900"}
          `,children:(0,f.formatCurrency)(a.ytd)})]}),i&&Object.keys(p).length>0&&(0,b.jsx)(b.Fragment,{children:c.filter(a=>p[a]?.length>0).map(d=>{let e=p[d]||[],g=l.has(d);return(0,b.jsx)("tr",{className:"bg-slate-50",children:(0,b.jsxs)("td",{colSpan:c.length+2,className:"px-3 py-1 pl-10",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600 cursor-pointer hover:text-slate-900",onClick:a=>{a.stopPropagation(),m(a=>{let b=new Set(a);return b.has(d)?b.delete(d):b.add(d),b})},children:[(0,b.jsx)(h,{expanded:g,className:"text-slate-400"}),(0,b.jsx)("span",{className:"font-medium",children:(0,f.formatMonth)(d)}),(0,b.jsxs)("span",{className:"text-slate-400",children:["(",e.length," transactions)"]}),(0,b.jsx)("span",{className:"ml-auto font-mono",children:(0,f.formatCurrency)(e.reduce((a,b)=>a+b.amount,0))})]}),g&&(0,b.jsx)("div",{className:"mt-2 space-y-1 pb-2",children:e.map(a=>(0,b.jsx)(j,{transaction:a},a.id))})]})},`${a.label}-${d}-group`)})})]})}function r({allowDrillDown:a=!0}){let{state:e}=(0,c.usePL)(),{transactions:g,months:h,tags:i}=e,{income:j,cogs:k,expenses:l}=(0,d.useMemo)(()=>0===g.length?{income:[],cogs:[],expenses:[]}:function(a,b,c){let d=a.filter(a=>!b[a.id]),e=(a,b)=>{let e={};c.forEach(a=>{e[a]=0});let f=0,g=[];for(let c of d)a.includes(c.accountCode)&&(!b||b(c))&&void 0!==e[c.month]&&(e[c.month]+=c.amount,f+=c.amount,g.push(c));return{monthly:e,ytd:f,transactions:g}},f=[],g={},h=0;for(let[a,b]of(c.forEach(a=>{g[a]=0}),Object.entries(n))){let{monthly:d,ytd:i,transactions:j}=e(b);f.push({label:a,monthlyAmounts:d,ytd:i,transactions:j}),c.forEach(a=>{g[a]+=d[a]}),h+=i}f.push({label:"Total Income",monthlyAmounts:g,ytd:h,isTotal:!0,isBold:!0});let i=[],j={},k=0;for(let[a,b]of(c.forEach(a=>{j[a]=0}),Object.entries(o))){let{monthly:d,ytd:f,transactions:g}=e(b);i.push({label:a,monthlyAmounts:d,ytd:f,transactions:g}),c.forEach(a=>{j[a]+=d[a]}),k+=f}let l={};c.forEach(a=>{l[a]=g[a]-j[a]});let m=h-k;i.push({label:"Gross Profit",monthlyAmounts:l,ytd:m,isTotal:!0,isBold:!0});let q=[],r={},s=0;for(let[a,b]of(c.forEach(a=>{r[a]=0}),Object.entries(p))){let{monthly:d,ytd:f,transactions:g}=e("accounts"in b?b.accounts:b,"filter"in b?b.filter:void 0);0!==f&&(q.push({label:a,monthlyAmounts:d,ytd:f,indent:1,transactions:g}),c.forEach(a=>{r[a]+=d[a]}),s+=f)}q.push({label:"Total Expenses",monthlyAmounts:r,ytd:s,isTotal:!0,isBold:!0});let t={};c.forEach(a=>{t[a]=l[a]-r[a]});let u=m-s;return q.push({label:"Net Profit",monthlyAmounts:t,ytd:u,isTotal:!0,isBold:!0}),{income:f,cogs:i,expenses:q}}(g,i,h),[g,i,h]);if(0===g.length)return null;let m=(c,d,e,g)=>(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:`w-1.5 h-6 rounded-full ${e}`}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-800",children:c})]}),(0,b.jsx)("div",{className:"overflow-x-auto border border-slate-200 rounded-xl shadow-sm bg-white",children:(0,b.jsxs)("table",{className:"w-full min-w-max",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-slate-50 border-b border-slate-200",children:[(0,b.jsx)("th",{className:"sticky left-0 bg-slate-50 px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:"Account"}),h.map(a=>(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,f.formatMonth)(a)},a)),(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-violet-700 uppercase tracking-wider w-28 bg-violet-100 border-l-2 border-violet-200",children:"YTD Total"})]})}),(0,b.jsx)("tbody",{children:d.map((c,d)=>(0,b.jsx)(q,{item:c,months:h,totalColorClass:g,allowDrillDown:a},d))})]})})]}),r=k.find(a=>"Gross Profit"===a.label),s=l.find(a=>"Net Profit"===a.label),t=k.filter(a=>"Gross Profit"!==a.label),u=l.filter(a=>"Net Profit"!==a.label),v=(a,c,d,e)=>{if(!a)return null;let g=j[j.length-1]?.ytd!==0?a.ytd/j[j.length-1].ytd*100:0;return(0,b.jsx)("div",{className:`mb-8 overflow-x-auto border ${e} rounded-xl shadow-sm`,children:(0,b.jsxs)("table",{className:"w-full min-w-max",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:`${d} border-b ${e}`,children:[(0,b.jsx)("th",{className:"sticky left-0 bg-inherit px-3 py-2 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider w-64 z-10",children:" "}),h.map(a=>(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600 uppercase tracking-wider w-24",children:(0,f.formatMonth)(a)},a)),(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-violet-700 uppercase tracking-wider w-28 bg-violet-100 border-l-2 border-violet-200",children:"YTD Total"})]})}),(0,b.jsx)("tbody",{children:(0,b.jsxs)("tr",{className:d,children:[(0,b.jsxs)("td",{className:"sticky left-0 bg-inherit px-3 py-3 font-bold text-lg text-slate-900",children:[c,(0,b.jsxs)("span",{className:"ml-2 text-sm font-normal text-slate-500",children:["(",g.toFixed(1),"% margin)"]})]}),h.map(c=>(0,b.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg
                    ${a.monthlyAmounts[c]<0?"text-red-600":"text-slate-900"}
                  `,children:(0,f.formatCurrency)(a.monthlyAmounts[c])},c)),(0,b.jsx)("td",{className:`px-3 py-3 text-right font-mono font-bold text-lg bg-violet-100 border-l-2 border-violet-200
                  ${a.ytd<0?"text-red-600":"text-violet-900"}
                `,children:(0,f.formatCurrency)(a.ytd)})]})})]})})};return(0,b.jsxs)("div",{children:[m("Income",j,"bg-emerald-500","bg-emerald-50"),m("Cost of Goods",t,"bg-orange-500","bg-orange-50"),v(r,"Gross Profit","bg-blue-50","border-blue-200"),m("Expenses",u,"bg-red-500","bg-red-50"),v(s,"Net Profit","bg-green-50","border-green-200")]})}function s(){let{state:a}=(0,c.usePL)(),[e,g]=(0,d.useState)(!1),[i,j]=(0,d.useState)(new Set),k=(0,d.useMemo)(()=>{let b={};for(let c of a.exclusions)b[c.category]||(b[c.category]={exclusions:[],total:0,justification:c.justification}),b[c.category].exclusions.push(c),b[c.category].total+=c.amount;return b},[a.exclusions]),l=(0,d.useMemo)(()=>a.exclusions.reduce((a,b)=>a+b.amount,0),[a.exclusions]),m=Object.keys(k).sort();return 0===a.exclusions.length?null:(0,b.jsxs)("div",{className:"mt-10 pt-8 border-t border-slate-200",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4 cursor-pointer group",onClick:()=>g(!e),children:[(0,b.jsx)(h,{expanded:e,className:"text-slate-400 group-hover:text-slate-600 transition-colors"}),(0,b.jsx)("div",{className:"w-1.5 h-6 rounded-full bg-slate-400"}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-700 group-hover:text-slate-900 transition-colors",children:"Exclusions"}),(0,b.jsxs)("span",{className:"text-sm text-slate-400",children:[a.exclusions.length," items"]}),(0,b.jsx)("span",{className:"ml-auto font-mono font-semibold text-slate-500",children:(0,f.formatCurrency)(l)})]}),e&&(0,b.jsxs)("div",{className:"space-y-2 pl-6",children:[(0,b.jsx)("p",{className:"text-sm text-slate-500 mb-4",children:"Non-recurring or owner-related items that would not transfer to a buyer."}),m.map(a=>{let c=k[a],d=i.has(a);return(0,b.jsxs)("div",{className:"border border-slate-200 rounded-lg overflow-hidden bg-white",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2.5 bg-slate-50/80 cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>{let b;(b=new Set(i)).has(a)?b.delete(a):b.add(a),j(b)},children:[(0,b.jsx)(h,{expanded:d,className:"text-slate-400"}),(0,b.jsx)("div",{className:`w-2 h-2 rounded-full ${{Personal:"bg-purple-500",Discretionary:"bg-purple-400","Owner Travel":"bg-blue-500","Owner Education":"bg-blue-400","Owner Tools":"bg-blue-300","Owner Expense":"bg-blue-600",Legal:"bg-red-500","Legal/Tax":"bg-red-400","One-Time Project":"bg-amber-500","One-Time COGS":"bg-amber-400","Terminated Agency":"bg-orange-500","Terminated Contractor":"bg-orange-400","Terminated Service":"bg-orange-300","M&A Process":"bg-slate-500"}[a]||"bg-slate-400"}`}),(0,b.jsx)("span",{className:"font-medium text-slate-800",children:a}),(0,b.jsx)("span",{className:"text-sm text-slate-400",children:c.exclusions.length}),(0,b.jsx)("span",{className:"ml-auto text-xs text-slate-400 max-w-sm truncate hidden md:block",children:c.justification}),(0,b.jsx)("span",{className:"font-mono text-sm text-slate-600 ml-4",children:(0,f.formatCurrency)(c.total)})]}),d&&(0,b.jsx)("div",{className:"divide-y divide-slate-100",children:c.exclusions.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-4 px-6 py-2 bg-white text-sm hover:bg-slate-50/50 transition-colors",children:[(0,b.jsx)("span",{className:"text-slate-400 font-mono text-xs w-20",children:a.date}),(0,b.jsx)("span",{className:"text-slate-700 flex-1 truncate",children:a.vendor||a.memo?.substring(0,40)||"Unknown"}),(0,b.jsx)("span",{className:"text-slate-400 text-xs w-28 truncate hidden lg:block",children:a.account.replace(/^\d{4}\s+/,"")}),(0,b.jsx)("span",{className:"font-mono text-slate-600 w-24 text-right",children:(0,f.formatCurrency)(a.amount)})]},`${a.date}-${a.amount}-${c}`))})]},a)})]})]})}function t({allowDrillDown:a=!0}){let{state:d,dispatch:e}=(0,c.usePL)();if(d.loading)return(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsxs)("div",{className:"flex items-center gap-3 text-slate-500",children:[(0,b.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,b.jsx)("span",{children:"Loading financial data..."})]})});if(d.error)return(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsxs)("div",{className:"text-red-600 bg-red-50 px-6 py-4 rounded-lg border border-red-200",children:[(0,b.jsx)("strong",{children:"Error:"})," ",d.error]})});let f=()=>{e({type:"TOGGLE_KH_BROKERS_VIEW"})};return(0,b.jsxs)("div",{children:[a&&(0,b.jsx)("div",{className:"flex items-center justify-end mb-6",children:(0,b.jsxs)("div",{className:"inline-flex rounded-lg border border-slate-200 bg-white p-1 shadow-sm",children:[(0,b.jsx)("button",{onClick:()=>d.khBrokersView||f(),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${d.khBrokersView?"bg-slate-900 text-white shadow-sm":"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:"Summary"}),(0,b.jsx)("button",{onClick:()=>!d.khBrokersView||f(),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${!d.khBrokersView?"bg-slate-900 text-white shadow-sm":"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:"Detailed"})]})}),(0,b.jsx)(g,{}),a?d.khBrokersView?(0,b.jsx)(r,{allowDrillDown:!0}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l,{section:"revenue",title:"Revenue",colorClass:"bg-emerald-500",totalColorClass:"bg-emerald-50",allowDrillDown:a}),(0,b.jsx)(l,{section:"cogs",title:"Cost of Goods Sold",colorClass:"bg-orange-500",totalColorClass:"bg-orange-50",allowDrillDown:a}),(0,b.jsx)(l,{section:"costOfSales",title:"Cost of Sales",colorClass:"bg-amber-500",totalColorClass:"bg-amber-50",allowDrillDown:a}),(0,b.jsx)(m,{type:"grossProfit"}),(0,b.jsx)(l,{section:"operatingExpenses",title:"Operating Expenses",colorClass:"bg-red-500",totalColorClass:"bg-red-50",allowDrillDown:a}),(0,b.jsx)(m,{type:"netIncome"})]}):(0,b.jsx)(r,{allowDrillDown:!1}),a&&(0,b.jsx)(s,{})]})}a.s(["PLViewer",()=>t],7839)}];

//# sourceMappingURL=spicy-pnl_src_components_pnl_PLViewer_tsx_a77abb16._.js.map